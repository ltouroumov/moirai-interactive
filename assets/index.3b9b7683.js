var E=Object.defineProperty;var w=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var y=(t,e,o)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,O=(t,e)=>{for(var o in e||(e={}))V.call(e,o)&&y(t,o,e[o]);if(w)for(var o of w(e))A.call(e,o)&&y(t,o,e[o]);return t};var _=(t,e,o)=>(y(t,typeof e!="symbol"?e+"":e,o),o);import{c as F,a as D,d as b,u as C,b as g,o as l,e as h,f as i,t as v,g as r,h as I,F as S,r as x,i as $,j as J,k as M}from"./vendor.b3874f97.js";const q=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function o(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(s){if(s.ep)return;s.ep=!0;const c=o(s);fetch(s.href,c)}};q();class K{constructor(){_(this,"scores",{});_(this,"objects",{});_(this,"children",{});_(this,"parents",{})}}const R=t=>{var e=!1;t.subscribe((o,n)=>{e=!0}),setInterval(()=>{const o=t.state.project;if(o&&e){console.log("Saving to localStorage");const n=JSON.stringify(t.state);localStorage.setItem("project",o),localStorage.setItem(`project/${o}`,n),e=!1}},1e3)};function z(t,e){const o=t.database.parents[e];if(o){const n=t.database.children[o].indexOf(e);n!==-1&&t.database.children[o].splice(n,1)}}function N(t,e){delete t.database.parents[e]}function j(t,e){const o=t.database.children[e];o&&o.forEach(n=>{j(t,n),N(t,n),k(t,n)}),delete t.database.children[e]}function k(t,e){delete t.database.objects[e]}var G=F({plugins:[D(),R],state(){return{project:"default",genCounters:{},database:new K}},getters:{findScore:t=>e=>t.database.scores[e],findElement:t=>e=>t.database.objects[e],findChildrenIds:t=>e=>t.database.children[e]},mutations:{genNextId(t,e){return t.genCounters.hasOwnProperty(e)||(t.genCounters[e]=0),t.genCounters[e]+=1,t.genCounters[e]},addObject(t,e){t.database.objects[e.id]=e},addChild(t,{parentId:e,childId:o}){t.database.children.hasOwnProperty(e)||(t.database.children[e]=[]),t.database.children[e].indexOf(o)===-1&&t.database.children[e].push(o),t.database.parents[o]=e},updateObject(t,{objectId:e,data:o}){const n=t.database.objects[e];t.database.objects[e]=O(O({},n),o)},removeChildren(t,e){j(t,e)},removeObject(t,e){z(t,e),N(t,e),j(t,e),k(t,e)}},actions:{async genNextId({commit:t,state:e},o){return t("genNextId",o),e.genCounters[o]}}}),p;(function(t){t.Section="section",t.Choice="choice",t.Option="option"})(p||(p={}));class H{constructor(e,o,n,s,c){_(this,"type",p.Section);this.id=e,this.title=o,this.header=n,this.footer=s,this.condition=c}}class Q{constructor(e,o,n,s,c){_(this,"type",p.Choice);this.id=e,this.title=o,this.text=n,this.scores=s,this.conditions=c}}class U{constructor(e,o,n,s){_(this,"type",p.Option);this.id=e,this.title=o,this.text=n,this.condition=s}}const W={class:"option"},X=i("div",{class:"scores"},null,-1),Y={class:"text"},Z=b({props:{optionId:String},setup(t){const e=t,o=C(),n=g(()=>o.getters.findElement(e.optionId));return(s,c)=>(l(),h("div",W,[i("h3",null,v(r(n).title),1),X,i("div",Y,v(r(n).text),1)]))}});function P(t,e){return function(n,s){let c=e();!s||!s.target||!c||t.commit("updateObject",{objectId:c,data:{[n]:s.target.value}})}}var B=(t,e)=>{const o=t.__vccOpts||t;for(const[n,s]of e)o[n]=s;return o};const T={class:"choice"},ee={class:"ch-header"},te=["value"],oe={key:0,class:"ch-conditions"},ne={key:1,class:"ch-scores"},se=["value"],ce={key:0,class:"ch-options"},ie={class:"ch-actions"},re={class:"ch-id"},ae=b({props:{choiceId:String},setup(t){const e=t,o=C(),n=g(()=>o.getters.findElement(e.choiceId)),s=g(()=>o.getters.findChildrenIds(e.choiceId)),c=P(o,()=>e.choiceId);async function d(){const m=await o.dispatch("genNextId",p.Option),a=`${p.Option}_${m}`;console.log("New Choice",a),o.commit("addObject",new U(a,`Option ${m}`,"Bar")),o.commit("addChild",{parentId:e.choiceId,childId:a})}async function f(){o.commit("removeObject",e.choiceId)}return(m,a)=>(l(),h("div",T,[i("div",ee,[i("input",{class:"ch-title",value:r(n).title,onInput:a[0]||(a[0]=u=>r(c)("title",u))},null,40,te),r(n).conditions?(l(),h("div",oe)):I("",!0),r(n).scores?(l(),h("div",ne)):I("",!0),i("textarea",{class:"ch-text",value:r(n).text,onInput:a[1]||(a[1]=u=>r(c)("text",u))},null,40,se)]),r(s)&&r(s).length>0?(l(),h("div",ce,[(l(!0),h(S,null,x(r(s),u=>(l(),$(Z,{optionId:u},null,8,["optionId"]))),256))])):I("",!0),i("div",ie,[i("span",re,v(r(n).id),1),i("button",{onClick:d},"Add Option"),i("button",{onClick:f},"Delete")])]))}});var de=B(ae,[["__scopeId","data-v-58b7fc85"]]);const le={class:"section"},ue={class:"sec-header"},he=["value"],pe=["value"],_e={class:"sec-choices"},fe={key:0,class:"sec-footer"},me={class:"sec-actions"},ge={class:"sec-id"},ve=b({props:{sectionId:String},setup(t){const e=t,o=C(),n=g(()=>o.getters.findElement(e.sectionId)),s=g(()=>o.getters.findChildrenIds(e.sectionId)),c=P(o,()=>e.sectionId);async function d(){const m=await o.dispatch("genNextId",p.Choice),a=`${p.Choice}_${m}`;console.log("New Choice",a),o.commit("addObject",new Q(a,`Choice ${m}`,"Bar")),o.commit("addChild",{parentId:e.sectionId,childId:a})}async function f(){o.commit("removeObject",e.sectionId)}return(m,a)=>(l(),h("section",le,[i("div",ue,[i("input",{class:"sec-header-title",type:"text",value:r(n).title,onInput:a[0]||(a[0]=u=>r(c)("title",u))},null,40,he),i("textarea",{class:"sec-header-text",value:r(n).header,onInput:a[1]||(a[1]=u=>r(c)("header",u))},null,40,pe)]),i("div",_e,[(l(!0),h(S,null,x(r(s),u=>(l(),$(de,{choiceId:u},null,8,["choiceId"]))),256))]),r(n).footer?(l(),h("div",fe,v(r(n).footer),1)):I("",!0),i("div",me,[i("span",ge,v(r(n).id),1),i("button",{onClick:d},"Add Choice"),i("button",{onClick:f},"Delete")])]))}});var be=B(ve,[["__scopeId","data-v-870a1564"]]);const Ce=b({setup(t){const e=C(),o=g(()=>e.getters.findChildrenIds("root"));async function n(){const c=await e.dispatch("genNextId",p.Section),d=`${p.Section}_${c}`;console.log("New Section",d),e.commit("addObject",new H(d,`Section ${c}`,"Bar")),e.commit("addChild",{parentId:"root",childId:d})}function s(){e.commit("removeChildren","root")}return J(()=>{console.log("Reloading data from storage");const c=localStorage.getItem("project");if(c!=null){const d=localStorage.getItem(`project/${c}`);if(d!=null){const f=JSON.parse(d);e.replaceState(f)}}}),(c,d)=>(l(),h(S,null,[i("div",{class:"toolbar"},[i("button",{onClick:n},"Add Section"),i("button",{onClick:s},"Clear")]),(l(!0),h(S,null,x(r(o),f=>(l(),$(be,{sectionId:f},null,8,["sectionId"]))),256))],64))}});const L=M(Ce);L.use(G);L.mount("#app");
