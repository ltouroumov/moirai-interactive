var J=Object.defineProperty;var D=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var w=(t,e,o)=>e in t?J(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,O=(t,e)=>{for(var o in e||(e={}))M.call(e,o)&&w(t,o,e[o]);if(D)for(var o of D(e))U.call(e,o)&&w(t,o,e[o]);return t};var h=(t,e,o)=>(w(t,typeof e!="symbol"?e+"":e,o),o);import{V as q,c as K,a as W,d as v,b,e as p,f as r,F as y,r as C,u as i,g,h as S,o as l,t as j,i as x,w as P,j as $,k as I,l as k,m as z,n as G,p as Q,q as X,s as Y,v as Z,x as T}from"./vendor.da39b49a.js";const ee=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(s){if(s.ep)return;s.ep=!0;const c=o(s);fetch(s.href,c)}};ee();class A{constructor(){h(this,"key");h(this,"name");h(this,"scores",{});h(this,"objects",{});h(this,"children",{});h(this,"parents",{});h(this,"genCounters",{})}}class te{constructor(e,o){this.key=e,this.name=o}}class B{constructor(){h(this,"projects",{})}}function oe(t){const e=new Uint8Array(t);return crypto.getRandomValues(e),Array.from(e,o=>o.toString(32).padStart(2,"0")).join("")}const ne={namespaced:!0,state(){return new B},getters:{findProject:t=>e=>t.projects[e]},mutations:{createProject(t){const e=oe(4);t.projects[e]=new te(e,"Untitled Project")}}};function se(t,e){const o=t.parents[e];if(o){const n=t.children[o].indexOf(e);n!==-1&&t.children[o].splice(n,1)}}function E(t,e){delete t.parents[e]}function N(t,e){const o=t.children[e];o&&o.forEach(n=>{N(t,n),E(t,n),L(t,n)}),delete t.children[e]}function L(t,e){delete t.objects[e]}const R=()=>new A,ce={namespaced:!0,state(){return R()},getters:{findScore:t=>e=>t.scores[e],findElement:t=>e=>t.objects[e],findChildrenIds:t=>e=>t.children[e]},mutations:{genNextId(t,e){return t.genCounters.hasOwnProperty(e)||(t.genCounters[e]=0),t.genCounters[e]+=1,t.genCounters[e]},addObject(t,e){t.objects[e.id]=e},addChild(t,{parentId:e,childId:o}){t.children.hasOwnProperty(e)||(t.children[e]=[]),t.children[e].indexOf(o)===-1&&t.children[e].push(o),t.parents[o]=e},updateObject(t,{objectId:e,data:o}){const n=t.objects[e];t.objects[e]=O(O({},n),o)},removeChildren(t,e){N(t,e)},removeObject(t,e){se(t,e),E(t,e),N(t,e),L(t,e)},setupProject(t,e){t.key=e.key,t.name=e.name},loadProject(t,e){Object.assign(t,e)},unloadProject(t){Object.assign(t,R())}},actions:{async genNextId({commit:t,state:e},o){return t("genNextId",o),e.genCounters[o]}}},re=new q({storage:window.localStorage,modules:["projects","database"],saveState:(t,e,o)=>{console.log(`Persisting ${t}`,e),o==null||o.setItem(`${t}/projects`,JSON.stringify(e.projects)),e.database.key&&(console.log(`Persisting project ${e.database.key}`),o==null||o.setItem(`${t}/projects/${e.database.key}`,JSON.stringify(e.database)))},restoreState:(t,e)=>{console.log(`Restoring ${t}`);function o(n,s){const c=e==null?void 0:e.getItem(n);return c?JSON.parse(c):s()}return{projects:o(`${t}/projects`,()=>new B),database:new A}}});var ie=K({plugins:[W(),re.plugin],modules:{projects:ne,database:ce}});const ae=r("h1",null,"Home",-1),de={class:"projects"},le={class:"project"},ue=$(" | "),pe=$(" | "),_e=$("Edit"),he=$(" | "),me=$("View"),fe=v({setup(t){const e=g(),o=b(()=>e.state.projects.projects);function n(){e.commit("projects/createProject")}return(s,c)=>{const a=S("router-link");return l(),p("div",null,[ae,r("div",de,[(l(!0),p(y,null,C(i(o),u=>(l(),p("div",le,[r("span",null,j(u.name),1),ue,r("span",null,j(u.key),1),pe,x(a,{to:{name:"edit",params:{project:u.key}}},{default:P(()=>[_e]),_:2},1032,["to"]),he,x(a,{to:{name:"view",params:{project:u.key}}},{default:P(()=>[me]),_:2},1032,["to"])]))),256)),r("button",{onClick:n},"Create Project")])])}}});var f;(function(t){t.Section="section",t.Choice="choice",t.Option="option"})(f||(f={}));class ve{constructor(e,o,n,s,c){h(this,"type",f.Section);this.id=e,this.title=o,this.header=n,this.footer=s,this.condition=c}}class be{constructor(e,o,n,s,c){h(this,"type",f.Choice);this.id=e,this.title=o,this.text=n,this.scores=s,this.conditions=c}}class ge{constructor(e,o,n,s){h(this,"type",f.Option);this.id=e,this.title=o,this.text=n,this.condition=s}}const je={class:"option"},$e=r("div",{class:"scores"},null,-1),ye={class:"text"},Ce=v({props:{optionId:String},setup(t){const e=t,o=g(),n=b(()=>o.getters["database/findElement"](e.optionId));return(s,c)=>(l(),p("div",je,[r("h3",null,j(i(n).title),1),$e,r("div",ye,j(i(n).text),1)]))}});function F(t,e){return function(n,s){let c=e();!s||!s.target||!c||t.commit("database/updateObject",{objectId:c,data:{[n]:s.target.value}})}}var H=(t,e)=>{const o=t.__vccOpts||t;for(const[n,s]of e)o[n]=s;return o};const xe={class:"choice"},Ie={class:"ch-header"},we=["value"],Oe={key:0,class:"ch-conditions"},Se={key:1,class:"ch-scores"},Pe=["value"],ke={key:0,class:"ch-options"},Ne={class:"ch-actions"},Ve={class:"ch-id"},De=v({props:{choiceId:String},setup(t){const e=t,o=g(),n=b(()=>o.getters["database/findElement"](e.choiceId)),s=b(()=>o.getters["database/findChildrenIds"](e.choiceId)),c=F(o,()=>e.choiceId);async function a(){const _=await o.dispatch("database/genNextId",f.Option),d=`${f.Option}_${_}`;console.log("New Choice",d),o.commit("database/addObject",new ge(d,`Option ${_}`,"Bar")),o.commit("database/addChild",{parentId:e.choiceId,childId:d})}async function u(){o.commit("database/removeObject",e.choiceId)}return(_,d)=>(l(),p("div",xe,[r("div",Ie,[r("input",{class:"ch-title",value:i(n).title,onInput:d[0]||(d[0]=m=>i(c)("title",m))},null,40,we),i(n).conditions?(l(),p("div",Oe)):I("",!0),i(n).scores?(l(),p("div",Se)):I("",!0),r("textarea",{class:"ch-text",value:i(n).text,onInput:d[1]||(d[1]=m=>i(c)("text",m))},null,40,Pe)]),i(s)&&i(s).length>0?(l(),p("div",ke,[(l(!0),p(y,null,C(i(s),m=>(l(),k(Ce,{optionId:m},null,8,["optionId"]))),256))])):I("",!0),r("div",Ne,[r("span",Ve,j(i(n).id),1),r("button",{onClick:a},"Add Option"),r("button",{onClick:u},"Delete")])]))}});var Ae=H(De,[["__scopeId","data-v-3c92047d"]]);const Be={class:"section"},Ee={class:"sec-header"},Le=["value"],Re=["value"],Fe={class:"sec-choices"},He={key:0,class:"sec-footer"},Je={class:"sec-actions"},Me={class:"sec-id"},Ue=v({props:{sectionId:String},setup(t){const e=t,o=g(),n=b(()=>o.getters["database/findElement"](e.sectionId)),s=b(()=>o.getters["database/findChildrenIds"](e.sectionId)),c=F(o,()=>e.sectionId);async function a(){const _=await o.dispatch("database/genNextId",f.Choice),d=`${f.Choice}_${_}`;console.log("New Choice",d),o.commit("database/addObject",new be(d,`Choice ${_}`,"Bar")),o.commit("database/addChild",{parentId:e.sectionId,childId:d})}async function u(){o.commit("database/removeObject",e.sectionId)}return(_,d)=>(l(),p("section",Be,[r("div",Ee,[r("input",{class:"sec-header-title",type:"text",value:i(n).title,onInput:d[0]||(d[0]=m=>i(c)("title",m))},null,40,Le),r("textarea",{class:"sec-header-text",value:i(n).header,onInput:d[1]||(d[1]=m=>i(c)("header",m))},null,40,Re)]),r("div",Fe,[(l(!0),p(y,null,C(i(s),m=>(l(),k(Ae,{choiceId:m},null,8,["choiceId"]))),256))]),i(n).footer?(l(),p("div",He,j(i(n).footer),1)):I("",!0),r("div",Je,[r("span",Me,j(i(n).id),1),r("button",{onClick:a},"Add Choice"),r("button",{onClick:u},"Delete")])]))}});var qe=H(Ue,[["__scopeId","data-v-59e4b5ea"]]);const Ke={class:"toolbar"},We=$("Home"),ze=v({setup(t){const e=X(),o=g(),n=b(()=>o.getters["database/findChildrenIds"]("root"));async function s(){const a=await o.dispatch("database/genNextId",f.Section),u=`${f.Section}_${a}`;console.log("New Section",u),o.commit("database/addObject",new ve(u,`Section ${a}`,"Bar")),o.commit("database/addChild",{parentId:"root",childId:u})}function c(){o.commit("database/removeChildren","root")}return z(()=>{const a=e.params.project;console.log(`Loading project ${a}`);const u=localStorage.getItem(`vuex/projects/${a}`);if(u){const _=JSON.parse(u);o.commit("database/loadProject",_)}if(!o.state.database.key){const _=o.getters["projects/findProject"](a);o.commit("database/setupProject",_)}}),G(()=>{o.commit("database/unloadProject")}),Q((a,u,_)=>{console.log(`Route change from ${u} to ${a}`)}),(a,u)=>{const _=S("router-link");return l(),p(y,null,[r("div",Ke,[r("button",{onClick:s},"Add Section"),r("button",{onClick:c},"Clear"),x(_,{to:{name:"home"}},{default:P(()=>[We]),_:1})]),(l(!0),p(y,null,C(i(n),d=>(l(),k(qe,{sectionId:d},null,8,["sectionId"]))),256))],64)}}}),Ge=r("h1",null,"Viewer",-1),Qe=[Ge],Xe=v({setup(t){return g(),(e,o)=>(l(),p("div",null,Qe))}}),Ye=[{name:"home",path:"/",component:fe},{name:"edit",path:"/edit/:project",component:ze},{name:"view",path:"/view/:project",component:Xe}],Ze=Y({history:Z(),routes:Ye});const Te={id:"app"},et=v({setup(t){return g(),(e,o)=>{const n=S("router-view");return l(),p("div",Te,[x(n)])}}});const V=T(et);V.use(ie);V.use(Ze);V.mount("#app");
