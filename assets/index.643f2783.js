var M=Object.defineProperty;var B=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var N=(t,e,o)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,V=(t,e)=>{for(var o in e||(e={}))U.call(e,o)&&N(t,o,e[o]);if(B)for(var o of B(e))K.call(e,o)&&N(t,o,e[o]);return t};var h=(t,e,o)=>(N(t,typeof e!="symbol"?e+"":e,o),o);import{V as z,c as W,a as G,d as b,u as g,b as j,r as $,o as i,e as u,f as r,F as w,g as S,h as a,p as Q,i as X,t as y,j as _,w as I,k as C,l as Y,m as Z,n as T,q as ee,s as x,v as E,x as te,y as oe,z as ne,_ as se,A as ce,B as re,C as ie}from"./vendor.82a60591.js";const ae=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}};ae();class L{constructor(){h(this,"key");h(this,"name");h(this,"scores",{});h(this,"objects",{});h(this,"children",{});h(this,"parents",{});h(this,"genCounters",{})}}class de{constructor(e,o){this.key=e,this.name=o}}class D{constructor(){h(this,"projects",{})}}function le(t){const e=new Uint8Array(t);return crypto.getRandomValues(e),Array.from(e,o=>o.toString(32).padStart(2,"0")).join("")}const ue={namespaced:!0,state(){return new D},getters:{findProject:t=>e=>t.projects[e]},mutations:{createProject(t){const e=le(4);t.projects[e]=new de(e,"Untitled Project")},removeProject(t,e){delete t.projects[e]}},actions:{removeProject({commit:t},e){t("removeProject",e),localStorage.removeItem(`vuex/projects/${e}`)}}};function pe(t,e){const o=t.parents[e];if(o){const c=t.children[o].indexOf(e);c!==-1&&t.children[o].splice(c,1)}}function R(t,e){delete t.parents[e]}function A(t,e){const o=t.children[e];o&&o.forEach(c=>{A(t,c),R(t,c),F(t,c)}),delete t.children[e]}function F(t,e){delete t.objects[e]}const H=()=>new L,_e={namespaced:!0,state(){return H()},getters:{findScore:t=>e=>t.scores[e],findElement:t=>e=>t.objects[e],findChildrenIds:t=>e=>t.children[e]},mutations:{genNextId(t,e){return t.genCounters.hasOwnProperty(e)||(t.genCounters[e]=0),t.genCounters[e]+=1,t.genCounters[e]},addObject(t,e){t.objects[e.id]=e},addChild(t,{parentId:e,childId:o}){t.children.hasOwnProperty(e)||(t.children[e]=[]),t.children[e].indexOf(o)===-1&&t.children[e].push(o),t.parents[o]=e},updateObject(t,{objectId:e,data:o}){const c=t.objects[e];t.objects[e]=V(V({},c),o)},removeChildren(t,e){A(t,e)},removeObject(t,e){pe(t,e),R(t,e),A(t,e),F(t,e)},setupProject(t,e){t.key=e.key,t.name=e.name},loadProject(t,e){Object.assign(t,e)},unloadProject(t){Object.assign(t,H())}},actions:{async genNextId({commit:t,state:e},o){return t("genNextId",o),e.genCounters[o]}}},he=new z({storage:window.localStorage,modules:["projects","database"],saveState:(t,e,o)=>{console.log(`Persisting ${t}`,e),o==null||o.setItem(`${t}/projects`,JSON.stringify(e.projects)),e.database.key&&(console.log(`Persisting project ${e.database.key}`),o==null||o.setItem(`${t}/projects/${e.database.key}`,JSON.stringify(e.database)))},restoreState:(t,e)=>{console.log(`Restoring ${t}`);function o(c,n){const s=e==null?void 0:e.getItem(c);return s?JSON.parse(s):n()}return{projects:o(`${t}/projects`,()=>new D),database:new L}}});var me=W({plugins:[G(),he.plugin],modules:{projects:ue,database:_e}});var P=(t,e)=>{const o=t.__vccOpts||t;for(const[c,n]of e)o[c]=n;return o};const q=t=>(Q("data-v-43a607c3"),t=t(),X(),t),fe=q(()=>r("h1",null,"Home",-1)),ve={class:"projects"},be=q(()=>r("div",{class:"header"},[r("span",{class:"proj-name"},"Project"),r("span",{class:"proj-key"},"Key"),r("span",{class:"proj-actions"},"Actions")],-1)),ge={class:"project"},je={class:"proj-name"},$e={class:"proj-key"},ye={class:"proj-actions btn-group"},Ce=C("Edit "),we=C("View "),Ie=["onClick"],ke=["onClick"],Pe={class:"tools"},Se={class:"btn-group"},xe=b({setup(t){const e=g(),o=j(()=>e.state.projects.projects);function c(){e.commit("projects/createProject")}function n(s){e.dispatch("projects/removeProject",s)}return(s,d)=>{const m=$("router-link");return i(),u(w,null,[fe,r("div",ve,[be,(i(!0),u(w,null,S(a(o),p=>(i(),u("div",ge,[r("span",je,y(p.name),1),r("span",$e,y(p.key),1),r("div",ye,[_(m,{class:"btn btn-outline-success",to:{name:"edit",params:{project:p.key}}},{default:I(()=>[Ce]),_:2},1032,["to"]),_(m,{class:"btn btn-outline-success",to:{name:"view",params:{project:p.key}}},{default:I(()=>[we]),_:2},1032,["to"]),r("button",{class:"btn btn-outline-primary",onClick:l=>s.exportProject(p.key)},"Export",8,Ie),r("button",{class:"btn btn-outline-danger",onClick:l=>n(p.key)},"Remove",8,ke)])]))),256)),r("div",Pe,[r("div",Se,[r("button",{onClick:c,class:"btn btn-primary"},"Create"),r("button",{onClick:d[0]||(d[0]=(...p)=>s.importProject&&s.importProject(...p)),class:"btn btn-primary"},"Import")])])])],64)}}});var Oe=P(xe,[["__scopeId","data-v-43a607c3"]]),v;(function(t){t.Section="section",t.Choice="choice",t.Option="option"})(v||(v={}));class Ne{constructor(e,o,c,n,s){h(this,"type",v.Section);this.id=e,this.title=o,this.header=c,this.footer=n,this.condition=s}}class Ve{constructor(e,o,c,n,s){h(this,"type",v.Choice);this.id=e,this.title=o,this.text=c,this.scores=n,this.conditions=s}}class Ee{constructor(e,o,c,n){h(this,"type",v.Option);this.id=e,this.title=o,this.text=c,this.condition=n}}const Ae={class:"toolbar"},Be={class:"nav nav-pills nav-fill editor-tabs"},Le=C(" Home "),De=C(" Sections "),Re=C(" Pages "),Fe=C(" Settings "),He={class:"editor-actions"},qe=C(" Add Section "),Je=b({setup(t){const e=Y(),o=g();j(()=>o.getters["database/findChildrenIds"]("root"));async function c(){const n=await o.dispatch("database/genNextId",v.Section),s=`${v.Section}_${n}`;console.log("New Section",s),o.commit("database/addObject",new Ne(s,`Section ${n}`,"Bar")),o.commit("database/addChild",{parentId:"root",childId:s})}return Z(()=>{const n=e.params.project;console.log(`Loading project ${n}`);const s=localStorage.getItem(`vuex/projects/${n}`);if(s){const d=JSON.parse(s);o.commit("database/loadProject",d)}if(!o.state.database.key){const d=o.getters["projects/findProject"](n);o.commit("database/setupProject",d)}}),T(()=>{o.commit("database/unloadProject")}),ee((n,s,d)=>{console.log("Route change",s,n),d()}),(n,s)=>{const d=$("font-awesome-icon"),m=$("router-link"),p=$("router-view");return i(),u(w,null,[r("div",Ae,[r("nav",Be,[_(m,{class:"nav-link",to:{name:"home"}},{default:I(()=>[_(d,{icon:"home"}),Le]),_:1}),_(m,{class:"nav-link",to:{name:"edit_sections",params:n.$route.params},"active-class":"active"},{default:I(()=>[De]),_:1},8,["to"]),_(m,{class:"nav-link",to:{name:"edit_pages",params:n.$route.params},"active-class":"active"},{default:I(()=>[Re]),_:1},8,["to"]),_(m,{class:"nav-link",to:{name:"edit_settings",params:n.$route.params},"active-class":"active"},{default:I(()=>[Fe]),_:1},8,["to"])]),r("div",He,[r("button",{class:"btn btn-primary",onClick:c},[_(d,{icon:["far","plus-square"]}),qe])])]),_(p)],64)}}}),Me={class:"option"},Ue=r("div",{class:"scores"},null,-1),Ke={class:"text"},ze=b({props:{optionId:String},setup(t){const e=t,o=g(),c=j(()=>o.getters["database/findElement"](e.optionId));return(n,s)=>(i(),u("div",Me,[r("h3",null,y(a(c).title),1),Ue,r("div",Ke,y(a(c).text),1)]))}});function J(t,e){return function(c,n){let s=e();!n||!n.target||!s||t.commit("database/updateObject",{objectId:s,data:{[c]:n.target.value}})}}const We={class:"choice"},Ge={class:"ch-header"},Qe=["value"],Xe={key:0,class:"ch-conditions"},Ye={key:1,class:"ch-scores"},Ze=["value"],Te={key:0,class:"ch-options"},et={class:"ch-actions"},tt={class:"ch-id"},ot=b({props:{choiceId:String},setup(t){const e=t,o=g(),c=j(()=>o.getters["database/findElement"](e.choiceId)),n=j(()=>o.getters["database/findChildrenIds"](e.choiceId)),s=J(o,()=>e.choiceId);async function d(){const p=await o.dispatch("database/genNextId",v.Option),l=`${v.Option}_${p}`;console.log("New Choice",l),o.commit("database/addObject",new Ee(l,`Option ${p}`,"Bar")),o.commit("database/addChild",{parentId:e.choiceId,childId:l})}async function m(){o.commit("database/removeObject",e.choiceId)}return(p,l)=>{const k=$("font-awesome-icon");return i(),u("div",We,[r("div",Ge,[r("input",{class:"form-control ch-title",value:a(c).title,onInput:l[0]||(l[0]=f=>a(s)("title",f))},null,40,Qe),a(c).conditions?(i(),u("div",Xe)):x("",!0),a(c).scores?(i(),u("div",Ye)):x("",!0),r("textarea",{class:"form-control ch-text",value:a(c).text,onInput:l[1]||(l[1]=f=>a(s)("text",f))},null,40,Ze)]),a(n)&&a(n).length>0?(i(),u("div",Te,[(i(!0),u(w,null,S(a(n),f=>(i(),E(ze,{optionId:f},null,8,["optionId"]))),256))])):x("",!0),r("div",et,[r("span",tt,y(a(c).id),1),r("button",{class:"btn btn-outline-primary",onClick:d},[_(k,{icon:"plus-square"})]),r("button",{class:"btn btn-outline-danger",onClick:m},[_(k,{icon:"trash"})])])])}}});var nt=P(ot,[["__scopeId","data-v-30320f69"]]);const st={class:"section"},ct={class:"sec-header"},rt=["value"],it=["value"],at={class:"sec-choices"},dt={key:0,class:"sec-footer"},lt={class:"sec-actions"},ut={class:"sec-id"},pt=b({props:{sectionId:String},setup(t){const e=t,o=g(),c=j(()=>o.getters["database/findElement"](e.sectionId)),n=j(()=>o.getters["database/findChildrenIds"](e.sectionId)),s=J(o,()=>e.sectionId);async function d(){const p=await o.dispatch("database/genNextId",v.Choice),l=`${v.Choice}_${p}`;console.log("New Choice",l),o.commit("database/addObject",new Ve(l,`Choice ${p}`,"Bar")),o.commit("database/addChild",{parentId:e.sectionId,childId:l})}async function m(){o.commit("database/removeObject",e.sectionId)}return(p,l)=>{const k=$("font-awesome-icon");return i(),u("section",st,[r("div",ct,[r("input",{class:"form-control sec-header-title",type:"text",value:a(c).title,onInput:l[0]||(l[0]=f=>a(s)("title",f))},null,40,rt),r("textarea",{class:"form-control sec-header-text",value:a(c).header,onInput:l[1]||(l[1]=f=>a(s)("header",f))},null,40,it)]),r("div",at,[(i(!0),u(w,null,S(a(n),f=>(i(),E(nt,{choiceId:f},null,8,["choiceId"]))),256))]),a(c).footer?(i(),u("div",dt,y(a(c).footer),1)):x("",!0),r("div",lt,[r("span",ut,y(a(c).id),1),r("button",{class:"btn btn-outline-primary",onClick:d},[_(k,{icon:"plus-square"})]),r("button",{class:"btn btn-outline-danger",onClick:m},[_(k,{icon:"trash"})])])])}}});var _t=P(pt,[["__scopeId","data-v-0642864c"]]);const ht=b({setup(t){const e=g(),o=j(()=>e.getters["database/findChildrenIds"]("root"));return(c,n)=>(i(),u("div",null,[(i(!0),u(w,null,S(a(o),s=>(i(),E(_t,{sectionId:s},null,8,["sectionId"]))),256))]))}}),mt={};function ft(t,e){return i(),u("b",null,"Pages")}var vt=P(mt,[["render",ft]]);const bt={};function gt(t,e){return i(),u("b",null,"Settings")}var jt=P(bt,[["render",gt]]);const $t=r("h1",null,"Viewer",-1),yt=[$t],Ct=b({setup(t){return g(),(e,o)=>(i(),u("div",null,yt))}}),wt=[{name:"home",path:"/",component:Oe},{name:"edit",path:"/edit/:project",component:Je,children:[{path:"",redirect:{name:"edit_sections"}},{name:"edit_sections",path:"sections",component:ht},{name:"edit_pages",path:"pages",component:vt},{name:"edit_settings",path:"pages",component:jt}]},{name:"view",path:"/view/:project",component:Ct}],It=te({history:oe(),routes:wt});const kt={id:"app"},Pt=b({setup(t){return g(),(e,o)=>{const c=$("router-view");return i(),u("div",kt,[_(c)])}}});ne.add(se,ce);const O=re(Pt);O.component("font-awesome-icon",ie);O.use(me);O.use(It);O.mount("#app");
