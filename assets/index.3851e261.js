var M=Object.defineProperty;var B=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var N=(t,e,o)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,V=(t,e)=>{for(var o in e||(e={}))U.call(e,o)&&N(t,o,e[o]);if(B)for(var o of B(e))K.call(e,o)&&N(t,o,e[o]);return t};var m=(t,e,o)=>(N(t,typeof e!="symbol"?e+"":e,o),o);import{V as z,c as W,a as G,d as b,u as g,b as j,r as $,o as a,e as u,f as r,F as y,g as x,h as i,p as Q,i as X,t as C,j as h,w as k,k as w,l as Y,m as Z,n as T,q as ee,s as te,v as I,x as E,y as oe,z as ne,A as se,_ as ce,B as re,C as ie,D as ae}from"./vendor.6ca86508.js";const de=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const s of c)if(s.type==="childList")for(const _ of s.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&n(_)}).observe(document,{childList:!0,subtree:!0});function o(c){const s={};return c.integrity&&(s.integrity=c.integrity),c.referrerpolicy&&(s.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?s.credentials="include":c.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(c){if(c.ep)return;c.ep=!0;const s=o(c);fetch(c.href,s)}};de();class D{constructor(){m(this,"key");m(this,"name");m(this,"scores",{});m(this,"objects",{});m(this,"children",{});m(this,"parents",{});m(this,"genCounters",{})}}class le{constructor(e,o){this.key=e,this.name=o}}class L{constructor(){m(this,"projects",{})}}function ue(t){const e=new Uint8Array(t);return crypto.getRandomValues(e),Array.from(e,o=>o.toString(32).padStart(2,"0")).join("")}const _e={namespaced:!0,state(){return new L},getters:{findProject:t=>e=>t.projects[e]},mutations:{createProject(t){const e=ue(4);t.projects[e]=new le(e,"Untitled Project")},removeProject(t,e){delete t.projects[e]}},actions:{removeProject({commit:t},e){t("removeProject",e),localStorage.removeItem(`vuex/projects/${e}`)}}};function pe(t,e){const o=t.parents[e];if(o){const n=t.children[o].indexOf(e);n!==-1&&t.children[o].splice(n,1)}}function R(t,e){delete t.parents[e]}function A(t,e){const o=t.children[e];o&&o.forEach(n=>{A(t,n),R(t,n),F(t,n)}),delete t.children[e]}function F(t,e){delete t.objects[e]}const H=()=>new D,he={namespaced:!0,state(){return H()},getters:{findScore:t=>e=>t.scores[e],findElement:t=>e=>t.objects[e],findChildrenIds:t=>e=>t.children[e]},mutations:{genNextId(t,e){return t.genCounters.hasOwnProperty(e)||(t.genCounters[e]=0),t.genCounters[e]+=1,t.genCounters[e]},addObject(t,e){t.objects[e.id]=e},addChild(t,{parentId:e,childId:o}){t.children.hasOwnProperty(e)||(t.children[e]=[]),t.children[e].indexOf(o)===-1&&t.children[e].push(o),t.parents[o]=e},updateObject(t,{objectId:e,data:o}){const n=t.objects[e];t.objects[e]=V(V({},n),o)},removeChildren(t,e){A(t,e)},removeObject(t,e){pe(t,e),R(t,e),A(t,e),F(t,e)},setupProject(t,e){t.key=e.key,t.name=e.name},loadProject(t,e){Object.assign(t,e)},unloadProject(t){Object.assign(t,H())}},actions:{async genNextId({commit:t,state:e},o){return t("genNextId",o),e.genCounters[o]}}},me=new z({storage:window.localStorage,modules:["projects","database"],saveState:(t,e,o)=>{console.log(`Persisting ${t}`,e),o==null||o.setItem(`${t}/projects`,JSON.stringify(e.projects)),e.database.key&&(console.log(`Persisting project ${e.database.key}`),o==null||o.setItem(`${t}/projects/${e.database.key}`,JSON.stringify(e.database)))},restoreState:(t,e)=>{console.log(`Restoring ${t}`);function o(n,c){const s=e==null?void 0:e.getItem(n);return s?JSON.parse(s):c()}return{projects:o(`${t}/projects`,()=>new L),database:new D}}});var fe=W({plugins:[G(),me.plugin],modules:{projects:_e,database:he}});var P=(t,e)=>{const o=t.__vccOpts||t;for(const[n,c]of e)o[n]=c;return o};const q=t=>(Q("data-v-43a607c3"),t=t(),X(),t),ve=q(()=>r("h1",null,"Home",-1)),be={class:"projects"},ge=q(()=>r("div",{class:"header"},[r("span",{class:"proj-name"},"Project"),r("span",{class:"proj-key"},"Key"),r("span",{class:"proj-actions"},"Actions")],-1)),je={class:"project"},$e={class:"proj-name"},ye={class:"proj-key"},Ce={class:"proj-actions btn-group"},we=w("Edit "),ke=w("View "),Ie=["onClick"],Se=["onClick"],Pe={class:"tools"},xe={class:"btn-group"},Oe=b({setup(t){const e=g(),o=j(()=>e.state.projects.projects);function n(){e.commit("projects/createProject")}function c(s){e.dispatch("projects/removeProject",s)}return(s,_)=>{const p=$("router-link");return a(),u(y,null,[ve,r("div",be,[ge,(a(!0),u(y,null,x(i(o),d=>(a(),u("div",je,[r("span",$e,C(d.name),1),r("span",ye,C(d.key),1),r("div",Ce,[h(p,{class:"btn btn-outline-success",to:{name:"edit",params:{project:d.key}}},{default:k(()=>[we]),_:2},1032,["to"]),h(p,{class:"btn btn-outline-success",to:{name:"view",params:{project:d.key}}},{default:k(()=>[ke]),_:2},1032,["to"]),r("button",{class:"btn btn-outline-primary",onClick:l=>s.exportProject(d.key)},"Export",8,Ie),r("button",{class:"btn btn-outline-danger",onClick:l=>c(d.key)},"Remove",8,Se)])]))),256)),r("div",Pe,[r("div",xe,[r("button",{onClick:n,class:"btn btn-primary"},"Create"),r("button",{onClick:_[0]||(_[0]=(...d)=>s.importProject&&s.importProject(...d)),class:"btn btn-primary"},"Import")])])])],64)}}});var Ne=P(Oe,[["__scopeId","data-v-43a607c3"]]),v;(function(t){t.Section="section",t.Choice="choice",t.Option="option"})(v||(v={}));class Ve{constructor(e,o,n,c,s){m(this,"type",v.Section);this.id=e,this.title=o,this.header=n,this.footer=c,this.condition=s}}class Ee{constructor(e,o,n,c,s){m(this,"type",v.Choice);this.id=e,this.title=o,this.text=n,this.scores=c,this.conditions=s}}class Ae{constructor(e,o,n,c){m(this,"type",v.Option);this.id=e,this.title=o,this.text=n,this.condition=c}}const Be={class:"toolbar"},De={class:"nav nav-pills nav-fill editor-tabs"},Le=w(" Home "),Re=w(" Sections "),Fe=w(" Pages "),He=w(" Settings "),qe={class:"editor-actions"},Je=w(" Add Section "),Me=b({setup(t){const e=Y(),o=Z(),n=g();j(()=>n.getters["database/findChildrenIds"]("root"));async function c(){const s=await n.dispatch("database/genNextId",v.Section),_=`${v.Section}_${s}`;console.log("New Section",_),n.commit("database/addObject",new Ve(_,`Section ${s}`,"Bar")),n.commit("database/addChild",{parentId:"root",childId:_})}return T(()=>{const s=o.params.project;console.log(`Loading project ${s}`);const _=localStorage.getItem(`vuex/projects/${s}`);if(_){const p=JSON.parse(_);n.commit("database/loadProject",p)}if(!n.state.database.key){const p=n.getters["projects/findProject"](s);n.commit("database/setupProject",p)}o.name==="edit"&&e.push({name:"edit_sections",params:o.params})}),ee(()=>{n.commit("database/unloadProject")}),te((s,_,p)=>{console.log("Route change",_,s),p()}),(s,_)=>{const p=$("font-awesome-icon"),d=$("router-link"),l=$("router-view");return a(),u(y,null,[r("div",Be,[r("nav",De,[h(d,{class:"nav-link",to:{name:"home"}},{default:k(()=>[h(p,{icon:"home"}),Le]),_:1}),h(d,{class:"nav-link",to:{name:"edit_sections",params:s.$route.params},"active-class":"active"},{default:k(()=>[Re]),_:1},8,["to"]),h(d,{class:"nav-link",to:{name:"edit_pages",params:s.$route.params},"active-class":"active"},{default:k(()=>[Fe]),_:1},8,["to"]),h(d,{class:"nav-link",to:{name:"edit_settings",params:s.$route.params},"active-class":"active"},{default:k(()=>[He]),_:1},8,["to"])]),r("div",qe,[r("button",{class:"btn btn-primary",onClick:c},[h(p,{icon:["far","plus-square"]}),Je])])]),h(l)],64)}}}),Ue={class:"option"},Ke=r("div",{class:"scores"},null,-1),ze={class:"text"},We=b({props:{optionId:String},setup(t){const e=t,o=g(),n=j(()=>o.getters["database/findElement"](e.optionId));return(c,s)=>(a(),u("div",Ue,[r("h3",null,C(i(n).title),1),Ke,r("div",ze,C(i(n).text),1)]))}});function J(t,e){return function(n,c){let s=e();!c||!c.target||!s||t.commit("database/updateObject",{objectId:s,data:{[n]:c.target.value}})}}const Ge={class:"choice"},Qe={class:"ch-header"},Xe=["value"],Ye={key:0,class:"ch-conditions"},Ze={key:1,class:"ch-scores"},Te=["value"],et={key:0,class:"ch-options"},tt={class:"ch-actions"},ot={class:"ch-id"},nt=b({props:{choiceId:String},setup(t){const e=t,o=g(),n=j(()=>o.getters["database/findElement"](e.choiceId)),c=j(()=>o.getters["database/findChildrenIds"](e.choiceId)),s=J(o,()=>e.choiceId);async function _(){const d=await o.dispatch("database/genNextId",v.Option),l=`${v.Option}_${d}`;console.log("New Choice",l),o.commit("database/addObject",new Ae(l,`Option ${d}`,"Bar")),o.commit("database/addChild",{parentId:e.choiceId,childId:l})}async function p(){o.commit("database/removeObject",e.choiceId)}return(d,l)=>{const S=$("font-awesome-icon");return a(),u("div",Ge,[r("div",Qe,[r("input",{class:"form-control ch-title",value:i(n).title,onInput:l[0]||(l[0]=f=>i(s)("title",f))},null,40,Xe),i(n).conditions?(a(),u("div",Ye)):I("",!0),i(n).scores?(a(),u("div",Ze)):I("",!0),r("textarea",{class:"form-control ch-text",value:i(n).text,onInput:l[1]||(l[1]=f=>i(s)("text",f))},null,40,Te)]),i(c)&&i(c).length>0?(a(),u("div",et,[(a(!0),u(y,null,x(i(c),f=>(a(),E(We,{optionId:f},null,8,["optionId"]))),256))])):I("",!0),r("div",tt,[r("span",ot,C(i(n).id),1),r("button",{class:"btn btn-outline-primary",onClick:_},[h(S,{icon:"plus-square"})]),r("button",{class:"btn btn-outline-danger",onClick:p},[h(S,{icon:"trash"})])])])}}});var st=P(nt,[["__scopeId","data-v-30320f69"]]);const ct={class:"section"},rt={class:"sec-header"},it=["value"],at=["value"],dt={class:"sec-choices"},lt={key:0,class:"sec-footer"},ut={class:"sec-actions"},_t={class:"sec-id"},pt=b({props:{sectionId:String},setup(t){const e=t,o=g(),n=j(()=>o.getters["database/findElement"](e.sectionId)),c=j(()=>o.getters["database/findChildrenIds"](e.sectionId)),s=J(o,()=>e.sectionId);async function _(){const d=await o.dispatch("database/genNextId",v.Choice),l=`${v.Choice}_${d}`;console.log("New Choice",l),o.commit("database/addObject",new Ee(l,`Choice ${d}`,"Bar")),o.commit("database/addChild",{parentId:e.sectionId,childId:l})}async function p(){o.commit("database/removeObject",e.sectionId)}return(d,l)=>{const S=$("font-awesome-icon");return a(),u("section",ct,[r("div",rt,[r("input",{class:"form-control sec-header-title",type:"text",value:i(n).title,onInput:l[0]||(l[0]=f=>i(s)("title",f))},null,40,it),r("textarea",{class:"form-control sec-header-text",value:i(n).header,onInput:l[1]||(l[1]=f=>i(s)("header",f))},null,40,at)]),r("div",dt,[(a(!0),u(y,null,x(i(c),f=>(a(),E(st,{choiceId:f},null,8,["choiceId"]))),256))]),i(n).footer?(a(),u("div",lt,C(i(n).footer),1)):I("",!0),r("div",ut,[r("span",_t,C(i(n).id),1),r("button",{class:"btn btn-outline-primary",onClick:_},[h(S,{icon:"plus-square"})]),r("button",{class:"btn btn-outline-danger",onClick:p},[h(S,{icon:"trash"})])])])}}});var ht=P(pt,[["__scopeId","data-v-0642864c"]]);const mt={key:0},ft={key:1},vt=r("p",null,"No Sections",-1),bt=[vt],gt=b({setup(t){const e=g(),o=j(()=>e.getters["database/findChildrenIds"]("root"));return(n,c)=>(a(),u(y,null,[i(o)&&i(o).length>0?(a(),u("div",mt,[(a(!0),u(y,null,x(i(o),s=>(a(),E(ht,{sectionId:s},null,8,["sectionId"]))),256))])):I("",!0),!i(o)||i(o).length===0?(a(),u("div",ft,bt)):I("",!0)],64))}}),jt={};function $t(t,e){return a(),u("b",null,"Pages")}var yt=P(jt,[["render",$t]]);const Ct={};function wt(t,e){return a(),u("b",null,"Settings")}var kt=P(Ct,[["render",wt]]);const It=r("h1",null,"Viewer",-1),St=[It],Pt=b({setup(t){return g(),(e,o)=>(a(),u("div",null,St))}}),xt=[{name:"home",path:"/",component:Ne},{name:"edit",path:"/edit/:project",component:Me,children:[{name:"edit_sections",path:"sections",component:gt},{name:"edit_pages",path:"pages",component:yt},{name:"edit_settings",path:"pages",component:kt}]},{name:"view",path:"/view/:project",component:Pt}],Ot=oe({history:ne(),routes:xt});const Nt={id:"app"},Vt=b({setup(t){return g(),(e,o)=>{const n=$("router-view");return a(),u("div",Nt,[h(n)])}}});se.add(ce,re);const O=ie(Vt);O.component("font-awesome-icon",ae);O.use(fe);O.use(Ot);O.mount("#app");
